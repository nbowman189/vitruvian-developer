version: '3.8'

# Override configuration for remote server deployment
# Usage: docker-compose -f docker-compose.yml -f docker-compose.remote.yml up -d

services:
  web:
    environment:
      # Production configuration for Cloudflare tunnel (SSL terminated at Cloudflare edge)
      - SESSION_COOKIE_SECURE=false
      - SESSION_COOKIE_SAMESITE=Lax
      - FLASK_ENV=production
      - SERVER_NAME=bowmanhomelabtech.net

  nginx:
    volumes:
      # Use HTTP-only nginx config (SSL terminated by Cloudflare)
      - ./docker/nginx/nginx-remote.conf:/etc/nginx/conf.d/nginx.conf:ro
    ports:
      # Map standard HTTP port (Cloudflare handles HTTPS)
      - "80:80"
